<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</title>

<style>
body{
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(to right, #4facfe, #00f2fe);
    margin:0;
    padding:0;
}

.container{
    width: 90%;
    max-width: 1000px;
    margin: 40px auto;
    background: #fff;
    padding: 30px;
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.2);
}

h1{
    text-align:center;
    color:#333;
    margin-bottom:30px;
}

.form-box{
    display:flex;
    gap:10px;
    margin-bottom:30px;
}

.form-box input{
    flex:1;
    padding:10px;
    border-radius:8px;
    border:1px solid #ccc;
    font-size:16px;
}

.form-box button{
    padding:10px 20px;
    border:none;
    border-radius:8px;
    background:#4facfe;
    color:#fff;
    font-weight:bold;
    cursor:pointer;
    transition:0.3s;
}

.form-box button:hover{
    background:#007bff;
}

table{
    width:100%;
    border-collapse:collapse;
}

table thead{
    background:#4facfe;
    color:#fff;
}

table th, table td{
    padding:12px;
    text-align:center;
}

table tr:nth-child(even){
    background:#f2f2f2;
}

.action-btn{
    padding:6px 12px;
    border:none;
    border-radius:6px;
    cursor:pointer;
    color:#fff;
}

.edit-btn{
    background:#28a745;
}

.delete-btn{
    background:#dc3545;
}

.edit-btn:hover{
    background:#218838;
}

.delete-btn:hover{
    background:#c82333;
}
</style>

</head>
<body>

<div class="container">

<h1>üõí ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h1>

<input type="hidden" id="id">

<div class="form-box">
    <input type="text" id="name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤">
    <input type="number" id="price" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤">
    <button onclick="saveProduct()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
</div>

<h2>üì¶ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>

<table>
<thead>
<tr>
<th>ID</th>
<th>‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
<th>‡∏£‡∏≤‡∏Ñ‡∏≤ (‡∏ö‡∏≤‡∏ó)</th>
<th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
</tr>
</thead>
<tbody id="productTable"></tbody>
</table>

</div>

<script>

const apiURL = "https://hosting.udru.ac.th/~it67040233103/workshop_api/api/products.php";

function loadProducts() {
    fetch(apiURL)
    .then(res => res.json())
    .then(data => {
        let table = document.getElementById("productTable");
        table.innerHTML = "";

        data.forEach(product => {
            table.innerHTML += `
                <tr>
                    <td>${product.id}</td>
                    <td>${product.product_name}</td>
                    <td>${product.price}</td>
                    <td>
                        <button class="action-btn edit-btn"
                        onclick="editProduct(${product.id}, '${product.product_name}', ${product.price})">
                        ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>

                        <button class="action-btn delete-btn"
                        onclick="deleteProduct(${product.id})">
                        ‡∏•‡∏ö</button>
                    </td>
                </tr>
            `;
        });
    });
}

function saveProduct() {

    let id = document.getElementById("id").value;
    let name = document.getElementById("name").value;
    let price = document.getElementById("price").value;

    if(name === "" || price === ""){
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö");
        return;
    }

    if (id === "") {
        fetch(apiURL, {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({product_name: name, price: price})
        }).then(() => loadProducts());
    } else {
        fetch(apiURL, {
            method: "PUT",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({id: id, product_name: name, price: price})
        }).then(() => {
            document.getElementById("id").value = "";
            loadProducts();
        });
    }

    document.getElementById("name").value = "";
    document.getElementById("price").value = "";
}

function editProduct(id, name, price) {
    document.getElementById("id").value = id;
    document.getElementById("name").value = name;
    document.getElementById("price").value = price;
}

function deleteProduct(id) {
    if (confirm("‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")) {
        fetch(apiURL, {
            method: "DELETE",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({id: id})
        }).then(() => loadProducts());
    }
}

loadProducts();

</script>

</body>
</html>
